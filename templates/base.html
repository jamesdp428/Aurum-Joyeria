<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <!-- Estilos CSS -->
    <link rel="stylesheet" href="{{ url_for('static', path='css/style.css') }}" />
    {% block extra_css %}{% endblock %}
    
    <link rel="icon" href="{{ url_for('static', path='img/logo-wind.svg') }}" class="icon-wind">
    
    <title>{% block title %}Aurum Joyería{% endblock %}</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Archivo+Black&family=Montserrat:ital,wght@0,100..900;1,100..900&family=Roboto+Condensed:ital,wght@0,100..900;1,100..900&family=Winky+Rough:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    
    <!-- Scripts principales -->
    <script defer src="{{ url_for('static', path='js/api.js') }}"></script>
    <script defer src="{{ url_for('static', path='js/menu.js') }}"></script>
    <script defer src="{{ url_for('static', path='js/carrito_global.js') }}"></script>
    <script defer src="{{ url_for('static', path='js/buscar.js') }}"></script>
    
    {% block extra_js %}{% endblock %}
</head>
<body {% block body_attrs %}{% endblock %}>

<!-- ========== NAVBAR ========== -->
<header class="navbar">
    <div class="top-bar">
        <div class="logo">
            <a href="/">
                <img src="{{ url_for('static', path='img/logo.svg') }}" alt="Logo Aurum" class="logo-img">
            </a>
        </div>

        <div class="menu-bottom-row"> 
            <div class="menu-hamburguesa" id="menuToggle">
                <span></span>
                <span></span>
                <span></span>
            </div>

            <div class="search-container">
                <input type="text" class="search-input" id="searchInput" placeholder="Buscar...">
                <button class="search-btn" id="searchBtn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="none" stroke="black" stroke-width="2" viewBox="0 0 24 24">
                        <circle cx="11" cy="11" r="8"/>
                        <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                    </svg>
                </button>
                <div class="search-results" id="searchResults"></div>
            </div>

            <div class="icons">
                <!-- Icono de usuario/login -->
                <a href="/login" id="userIcon" title="Iniciar sesion">
                    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" stroke="black" stroke-width="2" viewBox="0 0 24 24">
                        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
                        <circle cx="12" cy="7" r="4"/>
                    </svg>
                </a>
                
                <!-- Icono de carrito -->
                <a href="/carrito">
                    <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" stroke="black" stroke-width="2" viewBox="0 0 24 24">
                        <circle cx="9" cy="21" r="1"/>
                        <circle cx="20" cy="21" r="1"/>
                        <path d="M1 1h4l2.6 13.5a1 1 0 0 0 1 .8h9.7a1 1 0 0 0 1-.8L23 6H6"/>
                    </svg>
                </a>
            </div>
        </div> 
    </div>

    <!-- Menu movil -->
    <nav class="menu-mobile" id="menuMobile">
        <ul>
            <li><a href="/anillos">Anillos</a></li>
            <li><a href="/pulseras">Pulseras</a></li>
            <li><a href="/cadenas">Cadenas</a></li>
            <li><a href="/aretes">Aretes</a></li>
            <li><a href="/dijes">Dijes y Herrajes</a></li>
            <li><a href="/combos">Combos</a></li>
            <li><a href="/balineria">Balinería</a></li>
        </ul>
    </nav>

    <!-- Menu categorias (desktop) -->
    <nav class="menu-categorias">
        <ul>
            <li><a href="/anillos">Anillos</a></li>
            <li><a href="/pulseras">Pulseras</a></li>
            <li><a href="/cadenas">Cadenas</a></li>
            <li><a href="/aretes">Aretes</a></li>
            <li><a href="/dijes">Dijes y Herrajes</a></li>
            <li><a href="/combos">Combos</a></li>
            <li><a href="/balineria">Balinería</a></li>
        </ul>
    </nav>
</header>

<!-- ========== CONTENIDO PRINCIPAL ========== -->
{% block content %}{% endblock %}

<!-- ========== FOOTER ========== -->
<footer class="footer">
    <div class="footer-container">
        <div class="footer-section logo-section">
            <img src="{{ url_for('static', path='img/logo.svg') }}" class="logo-img" alt="Aurum Joyeria" />
        </div>

        <div class="footer-section">
            <h4>Enlaces</h4>
            <ul>
                <li><a href="/">Inicio</a></li>
                <li><a href="/pulseras">Pulseras</a></li>
                <li><a href="/anillos">Anillos</a></li>
                <li><a href="/cadenas">Cadenas</a></li>
                <li><a href="/aretes">Aretes</a></li>
                <li><a href="/balineria">Balinería</a></li>
            </ul>
        </div>

        <div class="footer-section">
            <h4>Contacto</h4>
            <ul>
                <li><span>&#128205; Medellin, Colombia</span></li>
                <li><span>&#128222; +57 321 779 8612</span></li>
                <li><span>&#9993; aurumjoyeriak@gmail.com</span></li>
            </ul>
        </div>

        <div class="footer-section">
            <h4>Siguenos</h4>
            <div class="footer-socials">
                <a href="https://www.instagram.com/aurum.18k_joyeria/" target="_blank" rel="noopener noreferrer">
                    <img src="{{ url_for('static', path='img/instagram.svg') }}" alt="Instagram">
                </a>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        <p>&copy; 2025 Aurum Joyeria. Todos los derechos reservados.</p>
    </div>
</footer>

<!-- BOTON FLOTANTE WHATSAPP -->
<a href="https://wa.me/573217798612" class="whatsapp-float" target="_blank" aria-label="Chat en WhatsApp" rel="noopener noreferrer">
    <img src="{{ url_for('static', path='img/whatsapp-svgrepo-com.svg') }}" alt="WhatsApp" />
</a>

<!-- Script para actualizar icono de usuario dinamicamente -->
<script>
document.addEventListener('DOMContentLoaded', () => {
    const checkAPILoaded = setInterval(() => {
        if (typeof getCurrentUser === 'function') {
            clearInterval(checkAPILoaded);
            updateUserIcon();
        }
    }, 100);

    function updateUserIcon() {
        const userIcon = document.getElementById('userIcon');
        if (!userIcon) return;
        
        try {
            const user = getCurrentUser();
            
            if (user) {
                userIcon.href = '/perfil';
                userIcon.title = 'Mi perfil (' + user.nombre + ')';
                console.log('Usuario detectado:', user.nombre);
            } else {
                userIcon.href = '/login';
                userIcon.title = 'Iniciar sesion';
                console.log('No hay usuario logueado');
            }
        } catch (error) {
            console.error('Error al actualizar icono de usuario:', error);
            userIcon.href = '/login';
        }
    }
});
</script>

<!-- Boton de admin (solo para administradores) -->
<script defer src="{{ url_for('static', path='js/admin-panel-button.js') }}"></script>

{% block extra_scripts %}{% endblock %}

</body>
</html>