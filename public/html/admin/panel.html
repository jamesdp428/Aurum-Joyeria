<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administración - Aurum Joyería</title>
    <link rel="stylesheet" href="../../css/style.css">
    <link rel="stylesheet" href="../../css/admin.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Condensed:wght@300;400;700&display=swap" rel="stylesheet">
</head>
<body>
    
    <!-- Navbar simplificado -->
    <header class="navbar">
        <div class="top-bar">
            <div class="logo">
                <a href="../../index.html">
                    <img src="../../img/logo.svg" alt="Logo Aurum" class="logo-img">
                </a>
            </div>
            <h1 style="color: #f9dc5e; margin: 0;">Panel de Administración</h1>
            <button id="logoutBtn" class="btn-logout">Cerrar Sesión</button>
        </div>
    </header>

    <main class="admin-container">
        
        <!-- Tabs de navegación -->
        <div class="admin-tabs">
            <button class="tab-btn active" data-tab="productos">Productos</button>
            <button class="tab-btn" data-tab="carrusel">Carrusel</button>
        </div>

        <!-- ========== TAB DE PRODUCTOS ========== -->
        <div class="tab-content active" id="productos-tab">
            
            <div class="admin-header">
                <h2>Gestión de Productos</h2>
                <button class="btn-primary" id="btnNuevoProducto">+ Nuevo Producto</button>
            </div>

            <!-- Filtros -->
            <div class="filters">
                <select id="filterCategoria" class="filter-select">
                    <option value="">Todas las categorías</option>
                    <option value="anillos">Anillos</option>
                    <option value="pulseras">Pulseras</option>
                    <option value="cadenas">Cadenas</option>
                    <option value="aretes">Aretes</option>
                    <option value="tobilleras">Tobilleras</option>
                    <option value="otros">Otros</option>
                </select>
                
                <label>
                    <input type="checkbox" id="filterDestacado"> Solo destacados
                </label>
            </div>

            <!-- Tabla de productos -->
            <div class="table-container">
                <table class="admin-table" id="productosTable">
                    <thead>
                        <tr>
                            <th>Imagen</th>
                            <th>Nombre</th>
                            <th>Categoría</th>
                            <th>Precio</th>
                            <th>Stock</th>
                            <th>Destacado</th>
                            <th>Activo</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Los productos se cargan aquí -->
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ========== TAB DE CARRUSEL ========== -->
        <div class="tab-content" id="carrusel-tab">
            
            <div class="admin-header">
                <h2>Gestión del Carrusel</h2>
                <button class="btn-primary" id="btnNuevoCarrusel">+ Nueva Imagen</button>
            </div>

            <!-- Grid de carrusel -->
            <div class="carrusel-grid" id="carruselGrid">
                <!-- Los items del carrusel se cargan aquí -->
            </div>
        </div>

    </main>

    <!-- ========== MODAL PRODUCTO ========== -->
    <div class="modal" id="modalProducto">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="modalProductoTitulo">Nuevo Producto</h2>
            
            <form id="formProducto" enctype="multipart/form-data">
                <input type="hidden" id="productoId">
                
                <div class="form-group">
                    <label for="productoNombre">Nombre *</label>
                    <input type="text" id="productoNombre" required>
                </div>
                
                <div class="form-group">
                    <label for="productoCategoria">Categoría *</label>
                    <select id="productoCategoria" required>
                        <option value="">Seleccionar...</option>
                        <option value="anillos">Anillos</option>
                        <option value="pulseras">Pulseras</option>
                        <option value="cadenas">Cadenas</option>
                        <option value="aretes">Aretes</option>
                        <option value="tobilleras">Tobilleras</option>
                        <option value="otros">Otros</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="productoDescripcion">Descripción</label>
                    <textarea id="productoDescripcion" rows="4"></textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="productoPrecio">Precio (opcional)</label>
                        <input type="number" id="productoPrecio" min="0" step="0.01">
                        <small>Dejar vacío para "Consultar"</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="productoStock">Stock</label>
                        <input type="number" id="productoStock" value="0" min="0">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="productoImagen">Imagen</label>
                    <input type="file" id="productoImagen" accept="image/*">
                    <div id="imagenPreview" class="imagen-preview"></div>
                </div>
                
                <div class="form-checkboxes">
                    <label>
                        <input type="checkbox" id="productoDestacado">
                        Producto destacado
                    </label>
                    
                    <label>
                        <input type="checkbox" id="productoActivo" checked>
                        Producto activo
                    </label>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="btnCancelarProducto">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <!-- ========== MODAL CARRUSEL ========== -->
    <div class="modal" id="modalCarrusel">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <h2 id="modalCarruselTitulo">Nueva Imagen del Carrusel</h2>
            
            <form id="formCarrusel" enctype="multipart/form-data">
                <input type="hidden" id="carruselId">
                
                <div class="form-group">
                    <label for="carruselTitulo">Título (opcional)</label>
                    <input type="text" id="carruselTitulo">
                </div>
                
                <div class="form-group">
                    <label for="carruselDescripcion">Descripción (opcional)</label>
                    <textarea id="carruselDescripcion" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="carruselOrden">Orden</label>
                    <input type="number" id="carruselOrden" value="0" min="0">
                    <small>Número más bajo aparece primero</small>
                </div>
                
                <div class="form-group">
                    <label for="carruselImagen">Imagen *</label>
                    <input type="file" id="carruselImagen" accept="image/*" required>
                    <div id="carruselImagenPreview" class="imagen-preview"></div>
                    <small>Recomendado: 1920x1080px o similar ratio 16:9</small>
                </div>
                
                <div class="form-checkboxes">
                    <label>
                        <input type="checkbox" id="carruselActivo" checked>
                        Activo
                    </label>
                </div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" id="btnCancelarCarrusel">Cancelar</button>
                    <button type="submit" class="btn-primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

<!-- Scripts -->
<script src="../../js/api.js"></script>
<script src="../../js/admin.js"></script>
<script src="../../js/admin-panel-button.js"></script>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const userIcon = document.getElementById('userIcon');
    if (!userIcon) return;
    
    const user = getCurrentUser ? getCurrentUser() : null;
    
    if (user) {
      userIcon.innerHTML = `
        <svg xmlns="http://www.w3.org/2000/svg" width="26" height="26" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/>
          <circle cx="12" cy="7" r="4"/>
        </svg>
      `;
      userIcon.title = `Mi perfil (${user.nombre})`;
      userIcon.href = '../perfil.html';
    } else {
      userIcon.title = 'Iniciar sesión';
      userIcon.href = '../login.html';
    }
  });
</script>
    
</body>
</html>